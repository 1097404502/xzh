{
    "volume_extension:types_manage:create": "role:zetta:volume_type:create and field:volume_type:create:set_public:write",
    "context_is_admin": "role:zetta:project:management_all_projects or is_admin:True",
    "matching_project_id": "project_id:%(project_id)s",
    "matching_user_id": "user_id:%(user_id)s",

    "create_snapshot": "role:zetta:volume:create_snapshot",
    "create_backup": "role:zetta:instance_backup:create or role:zetta:volume:create_backup",
    "default": "@",

    "volume_list_all_projects": "role:zetta:volume:read_all_projects",
    "volume_list_project": "(rule:matching_project_id and role:zetta:volume:read_project) or rule:volume_list_all_projects",
    "volume_list_user": "(rule:matching_user_id and role:zetta:volume:read_user) or rule:volume_list_project",
    "volume_list": "rule:volume_list_user",

    "volume_extend_create": "role:zetta:instance:create or role:zetta:instance:delete or role:zetta:instance:attach_volume or role:zetta:instance:detach_volume or role:zetta:instance_backup:create",
    "volume_extend_list": "role:zetta:instance:resize or role:zetta:instance:migrate or role:zetta:instance:power or role:zetta:instance:delete or role:zetta:instance_backup:read_user",
    "volume_extend_delete": "rule:volume_extend_create or role:zetta:instance_backup:delete",

    "volume_api:volume:show": "rule:volume_list or rule:volume_extend_list",
    "volume_api:volume:delete": "(rule:volume_list and role:zetta:volume:delete) or rule:volume_extend_delete",
    "volume_api:volume:index:user": "rule:volume_list or rule:volume_extend_list",
    "volume_api:volume:index:project": "rule:volume_list_project",
    "volume_api:volume:index:all_projects": "rule:volume_list_all_projects",
    "volume_api:volume:create": "(role:zetta:volume:create or rule:volume_extend_create) and field:volume:create:add_zvision_user:write",
    "volume_api:volume:update": "rule:volume_list and role:zetta:volume:update",

    "volume_api:volume_metadata:index": "rule:volume_list",
    "volume_api:volume_metadata:update": "rule:volume_list and role:zetta:volume:set_metadata",
    "volume_api:volume_metadata:create": "rule:volume_list and role:zetta:volume:set_metadata",
    "volume_api:volume_metadata:delete": "rule:volume_list and role:zetta:volume:set_metadata",
    "volume_api:volume_metadata:show": "rule:volume_list",

    "volume_extension:volume_actions:upload_image": "rule:volume_list and role:zetta:volume:create_image",
    "volume_extension:volume_actions:attach": "(rule:volume_list and role:zetta:volume:add_vm) or rule:volume_extend_create",
    "volume_extension:volume_actions:detach": "(rule:volume_list and role:zetta:volume:delete_vm) or rule:volume_extend_create",
    "volume_extension:volume_actions:reserve": "@",
    "volume_extension:volume_actions:unreserve": "@",
    "volume_extension:volume_actions:begin_detaching": "@",
    "volume_extension:volume_actions:roll_detaching": "@",
    "volume_extension:volume_actions:initialize_connection": "@",
    "volume_extension:volume_actions:terminate_connection": "@",
    "volume_extension:volume_actions:extend": "(rule:volume_list and role:zetta:volume:extend) or rule:volume_extend_list",
    "volume_extension:volume_actions:update_readonly_flag": "@",
    "volume_extension:volume_actions:retype": "@",
    "volume_extension:volume_actions:set_bootable": "@",
    "volume_extension:volume_actions:reset_data": "@",

    "volume_extension:volume_admin_actions:reset_status": "rule:volume_list and role:zetta:volume:reset_status",
    "volume_extension:volume_admin_actions:force_delete": "rule:volume_list and role:zetta:volume:delete",
    "volume_extension:volume_admin_actions:force_detach": "rule:volume_list and role:zetta:volume:delete_vm",
    "volume_extension:volume_admin_actions:migrate_volume": "rule:volume_list_all_projects",
    "volume_extension:volume_admin_actions:migrate_volume_completion": "rule:volume_list_all_projects",

    "backup_list_all_projects": "role:zetta:instance_backup:read_all_projects",
    "backup_list_project": "(rule:matching_project_id and role:zetta:instance_backup:read_project) or rule:backup_list_all_projects",
    "backup_list_user": "(rule:matching_user_id and role:zetta:instance_backup:read_user) or rule:backup_list_project",
    "backup_list": "rule:backup_list_user",
    "bakcup_create": "role:zetta:instance_backup:create",

    "volume_api:backup:index:user": "rule:backup_list",
    "volume_api:backup:index:project": "rule:backup_list_project",
    "volume_api:backup:index:all_projects": "rule:backup_list_all_projects",
    "volume_api:backup:create": "rule:bakcup_create",
    "volume_api:backup:delete": "role:zetta:instance_backup:delete or rule:bakcup_create",
    "volume_api:backup:show": "rule:backup_list",
    "volume_api:backup:update": "rule:bakcup_create",
    "volume_api:backup:restore": "role:zetta:instance_backup:restore",
    "volume_api:backup:import": "role:storage:backup:import",
    "volume_api:backup:export": "role:storage:backup:export",

    "snapshot_list_all_projects": "role:zetta:instance_snapshot:read_all_projects or rule:backup_list_all_projects",
    "snapshot_list_project": "(rule:matching_project_id and role:zetta:instance_snapshot:read_project) or rule:snapshot_list_all_projects or rule:backup_list_project",
    "snapshot_list_user": "(rule:matching_user_id and role:zetta:instance_snapshot:read_user) or rule:snapshot_list_project or rule:backup_list_user",
    "snapshot_list": "rule:snapshot_list_user or rule:backup_list",

    "extend_snapshot_modified": "role:zetta:instance:resize or rule:bakcup_create or role:zetta:instance_backup:delete",
    "snapshot_create": "(rule:snapshot_list and role:zetta:instance_snapshot:create) or rule:extend_snapshot_modified",
    "snapshot_delete": "(rule:snapshot_list and role:zetta:instance_snapshot:delete) or rule:extend_snapshot_modified",

    "volume_api:snapshot:index": "rule:snapshot_list or rule:extend_snapshot_modified",
    "volume_api:snapshot:index:get_all_tenants": "rule:snapshot_list_all_projects",
    "volume_api:snapshot:show": "rule:snapshot_list or rule:extend_snapshot_modified",
    "volume_api:snapshot:update": "rule:snapshot_create",
    "volume_api:snapshot:create": "rule:snapshot_create",
    "volume_api:snapshot:delete": "rule:snapshot_delete",
    "volume_api:snapshot:restore": "role:zetta:instance_snapshot:restore",
    "volume_api:snapshot:clone": "role:zetta:instance_snapshot:clone",

    "volume_api:snapshot_metadata:index": "rule:snapshot_list",
    "volume_api:snapshot_metadata:show": "rule:snapshot_list",
    "volume_api:snapshot_metadata:update": "rule:snapshot_create",
    "volume_api:snapshot_metadata:create": "rule:snapshot_create",
    "volume_api:snapshot_metadata:delete": "rule:snapshot_delete",

    "volume_extension:extended_snapshot_attributes": "@",
    "volume_extension:snapshot_admin_actions:reset_status": "rule:snapshot_list and rule:snapshot_create",
    "volume_extension:snapshot_admin_actions:force_delete": "rule:snapshot_list and rule:snapshot_delete",
    "snapshot_extension:snapshot_actions:update_snapshot_status": "",

    "volume_extension:volume_image_metadata:set_image_metadata": "@",
    "volume_extension:volume_image_metadata:unset_image_metadata": "@",
    "volume_extension:volume_host_attribute": "@",
    "volume_extension:volume_tenant_attribute": "@",
    "volume_extension:volume_mig_status_attribute": "@",
    "backup_extension:backup_tenant_attribute": "@",
    "volume_extension:backup_admin_actions:reset_status": "rule:context_is_admin or (rule:project_admin_or_owner)",
    "volume_extension:backup_admin_actions:force_delete": "rule:context_is_admin or (rule:project_admin_or_owner)",


    "volume_extension:types_manage:index": "role:zetta:volume_type:read",
    "volume_extension:types_manage:show": "role:zetta:volume_type:read",
    "volume_extension:types_manage:create": "role:zetta:volume_type:create and field:volume_type:create:set_public:write",
    "volume_extension:types_manage:update": "role:zetta:volume_type:update and field:volume_type:update:set_public:write",
    "volume_extension:types_manage:delete": "role:zetta:volume_type:delete",
    "volume_extension:volume_type_access": "role:zetta:volume_type:set_access_permission",
    "volume_extension:access_types_qos_specs_id": "@",
    "volume_extension:access_types_extra_specs": "@",
    "volume_extension:volume_type_access:addProjectAccess": "role:zetta:volume_type:set_access_permission",
    "volume_extension:volume_type_access:removeProjectAccess": "role:zetta:volume_type:set_access_permission",

    "volume_extension:types_extra_specs:index": "role:zetta:volume_type:read",
    "volume_extension:types_extra_specs:show": "role:zetta:volume_type:read",
    "volume_extension:types_extra_specs:create": "role:zetta:volume_type:create",
    "volume_extension:types_extra_specs:update": "role:zetta:volume_type:update",
    "volume_extension:types_extra_specs:delete": "role:zetta:volume_type:delete",

    "volume_qos_specs_list_all_projects": "role:zetta:volume_type_qos:read_all_projects",
    "volume_qos_specs_list_project": "rule:matching_project_id and role:zetta:volume_type_qos:read_project",
    "volume_qos_specs_list": "rule:volume_qos_specs_list_all_projects or rule:volume_qos_specs_list_project",

    "volume_extension:qos_specs_manage:index": "rule:volume_qos_specs_list_project",
    "volume_extension:qos_specs_manage:index:all": "role:zetta:volume_type_qos:read_all_projects",
    "volume_extension:qos_specs_manage:index:project": "rule:volume_qos_specs_list",

    "volume_extension:qos_specs_manage:show": "rule:volume_qos_specs_list",
    "volume_extension:qos_specs_manage:create": "role:zetta:volume_type_qos:create and field:volume_type_qos:create:set_public:write",
    "volume_extension:qos_specs_manage:update": "rule:volume_qos_specs_list and role:zetta:volume_type_qos:update and field:volume_type_qos:update:set_public:write",
    "volume_extension:qos_specs_manage:delete": "rule:volume_qos_specs_list and role:zetta:volume_type_qos:delete",
    "volume_extension:qos_specs_manage:associations": "rule:volume_qos_specs_list",
    "volume_extension:qos_specs_manage:associate": "role:zetta:volume_type_qos:attach_volume_type",
    "volume_extension:qos_specs_manage:disassociate": "role:zetta:volume_type_qos:detach_volume_type",
    "volume_extension:qos_specs_manage:disassociate_all": "role:zetta:volume_type_qos:detach_volume_type",

    "volume_extension:quotas:show": "@",
    "volume_extension:quotas:defaults": "@",
    "volume_extension:quotas:update": "role:zetta:project:set_quota",
    "volume_extension:quotas:delete": "role:zetta:project:set_quota",

    "limit_extension:used_limits": "rule:matching_user_id",

    "volume_extension:services:index": "@",
    "volume_extension:services:update": "@",
    "volume_extension:backend_store_type:list": "role:zetta:storage_backend_type:read",
    "volume_extension:backend_store_type:show": "role:zetta:storage_backend_type:read",
    "volume_extension:backend_store_type:update": "role:zetta:storage_backend_type:update",
    "volume_extension:backend_store_type:create": "role:zetta:storage_backend_type:create",
    "volume_extension:backend_store_type:delete": "role:zetta:storage_backend_type:delete",

    "volume_extension:backend_pool_manage:index": "role:zetta:storage_backend:pool_read",
    "volume_extension:backend_pool_manage:show": "role:zetta:storage_backend:pool_read",
    "volume_extension:backend_pool_manage:create": "role:zetta:storage_backend:pool_create",
    "volume_extension:backend_pool_manage:update": "role:zetta:storage_backend:pool_update",
    "volume_extension:backend_pool_manage:delete": "role:zetta:storage_backend:pool_delete",

    "volume:get_snapshot": "@",
    "volume:get_all_snapshots": "@",
    "volume:get_all_tenants_snapshots": "@",
    "volume:create_snapshot": "@",
    "volume:delete_snapshot": "@",
    "volume:update_snapshot": "@",
    "volume:restore_snapshot": "@",

    "backup:create": "@",
    "backup:delete": "@",
    "backup:get": "@",
    "backup:get_all": "@",
    "backup:restore": "@",
    "backup:backup-import": "@",
    "backup:backup-export": "@",
    "volume:terminate_connection": "@",
    "volume:unreserve_volume": "@",
    "volume:initialize_connection": "@",
    "volume:retype": "@",
    "volume:update_readonly_flag": "@",
    "volume:migrate_volume_completion": "@",
    "volume:migrate_volume": "@",
    "volume:copy_volume_to_image": "@",
    "volume:get_volume_image_metadata": "@",
    "volume:get_volumes_image_metadata": "@",
    "volume:create_snapshot_force": "@",
    "volume:accept_transfer": "@",
    "volume:roll_detaching": "@",
    "volume:begin_detaching": "@",
    "volume:reserve_volume": "@",
    "volume:get_volume": "@",
    "volume:extend": "@",
    "volume:update": "@",
    "volume:attach": "@",
    "volume:detach": "@",
    "volume:upload_image": "@",
    "volume:get_volume_metadata": "@",
    "volume:delete_volume_metadata": "@",
    "volume:update_volume_metadata": "@",
    "volume:get_volume_admin_metadata": "@",
    "volume:update_volume_admin_metadata": "@",
    "volume:create": "@",
    "volume:delete": "@",
    "volume:get": "@",
    "volume:get_all": "@",
    "volume:get_all_tenants": "@",
    "ceph:create": "",
    "ceph:get_all": "",
    "ceph:get": "",
    "ceph:delete": "",
    "ceph:update": ""
}
